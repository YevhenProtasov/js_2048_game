var t={},e=(t={getCapitalizedWord:function(t){return t[0].toUpperCase()+t.slice(1)},getRandomArrayIndex:function(t){return Math.floor(Math.random()*t.length)}}).getCapitalizedWord,s=t.getRandomArrayIndex;const a=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}moveLeft(){this.canMoveLeft()&&"playing"===this.status&&(this.move(),this.addTile(),this.isGameContinue())}moveRight(){this.canMoveRight()&&"playing"===this.status&&(this.reverseBoard(),this.move(),this.reverseBoard(),this.addTile(),this.isGameContinue())}moveUp(){this.canMoveUp()&&"playing"===this.status&&(this.transposeBoard(),this.move(),this.transposeBoard(),this.addTile(),this.isGameContinue())}moveDown(){this.canMoveDown()&&"playing"===this.status&&(this.transposeBoard(),this.reverseBoard(),this.move(),this.reverseBoard(),this.transposeBoard(),this.addTile(),this.isGameContinue())}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.addTile(),this.addTile(),this.status="playing"}restart(){this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}getEmptyCells(){return this.state.reduce((t,e,s)=>(e.forEach((e,a)=>{0===e&&t.push({rowIndex:s,colIndex:a})}),t),[])}addTile(){let t=this.getEmptyCells();if(t.length>0){let e=s(t),{rowIndex:a,colIndex:i}=t[e];this.state[a][i]=.1>=Math.random()?4:2}}move(){this.state=this.state.map(t=>t.filter(t=>0!==t)),this.state.forEach(t=>{for(let e=0;e<t.length-1;e++)if(t[e]===t[e+1]){this.score+=2*t[e],t[e]+=t[e+1],t[e+1]=0,e++;continue}}),this.state=this.state.map(t=>t.filter(t=>0!==t)),this.state.forEach(t=>{for(;t.length<4;)t.push(0)})}isBoardHas2048(){return this.state.some(t=>t.includes(2048))}reverseBoard(){this.state=this.state.map(t=>t.reverse())}transposeBoard(){this.state=this.state[0].map((t,e)=>this.state.map(t=>t[e]))}canMoveLeft(){return this.state.some(t=>{let e=t.filter(t=>0!==t);if(0===e.length)return!1;for(let s=0;s<e.length;s++)if(e[s]===e[s+1]||t.indexOf(e[s])!==e.indexOf(e[s]))return!0})}canMoveRight(){this.reverseBoard();let t=this.canMoveLeft();return this.reverseBoard(),t}canMoveUp(){this.transposeBoard();let t=this.canMoveLeft();return this.transposeBoard(),t}canMoveDown(){this.transposeBoard(),this.reverseBoard();let t=this.canMoveLeft();return this.reverseBoard(),this.transposeBoard(),t}canMove(){return this.canMoveLeft()||this.canMoveRight()||this.canMoveUp()||this.canMoveDown()}isGameContinue(){return this.isBoardHas2048()?(this.status="win",!1):!!this.canMove()||(this.status="lose",!1)}},i=document.querySelector(".button"),r=document.querySelector("tbody"),o=document.querySelector(".game-score"),n=document.querySelector(".message-start"),h=document.querySelector(".message-win"),d=document.querySelector(".message-lose");i.addEventListener("click",()=>{let t=i.className.split(" ");"start"===t[1]&&(a.start(),u()),"restart"===t[1]&&(a.restart(),u()),c(),i.classList.toggle("start"),i.classList.toggle("restart");let s=i.className.split(" ");i.textContent=e(s[1])});const l=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"];function c(){a.getState().forEach((t,e)=>{let s=document.createElement("tr");s.classList.add("field-row"),t.forEach(t=>{let e=document.createElement("td");e.classList.add("field-cell"),t&&e.classList.add(`field-cell--${t}`),e.textContent=t||"",s.appendChild(e)}),r.replaceChild(s,r.rows[e])}),o.textContent=a.getScore()}function u(){switch(a.getStatus()){case"idle":n.classList.remove("hidden"),h.classList.add("hidden"),d.classList.add("hidden");break;case"playing":n.classList.add("hidden");break;case"win":h.classList.remove("hidden");break;case"lose":d.classList.remove("hidden")}}document.addEventListener("keydown",t=>{"playing"===a.getStatus()&&("ArrowRight"===t.key&&a.moveRight(),"ArrowLeft"===t.key&&a.moveLeft(),"ArrowUp"===t.key&&a.moveUp(),"ArrowDown"===t.key&&a.moveDown(),l.includes(t.key)&&(c(),u()))});
//# sourceMappingURL=index.51c7577f.js.map
